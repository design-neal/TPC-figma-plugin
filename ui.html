<!DOCTYPE html>
<html>
<head>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background: #F3F4F5;
      color: #110F1A;
    }

    /* ÌÉ≠ Ïä§ÌÉÄÏùº */
    .tabs-container {
      position: relative;
      overflow: visible;
      border-bottom: 1px solid #D7D8E5;
    }

    .tabs {
      display: flex;
      background: transparent;
      position: relative;
      overflow-x: scroll;
      overflow-y: hidden;
      scroll-behavior: smooth;
      -webkit-overflow-scrolling: touch;
      scrollbar-width: none;
      -ms-overflow-style: none;
      padding: 0 20px;
      gap: 24px;
    }

    .tabs::-webkit-scrollbar {
      display: none;
    }

    .tab {
      flex: 0 0 auto;
      height: 42px;
      padding: 0 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      font-size: 16px;
      font-weight: 500;
      color: #838499;
      background: transparent;
      border: none;
      cursor: grab;
      position: relative;
      white-space: nowrap;
      user-select: none;
    }

    .tab.active {
      color: #110F1A;
      font-weight: 600;
    }

    .tab.active::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: #110F1A;
      border-radius: 2px;
    }

    .tab-content {
      display: none;
    }

    .tab-content.active {
      display: block;
    }

    /* ÌÉÄÏù¥ÌãÄ ÏÑπÏÖò */
    .title-section {
      padding: 28px 20px 12px 20px;
    }

    .page-title {
      font-size: 22px;
      font-weight: 700;
      color: #110F1A;
    }

    /* Î©îÏù∏ Ïª®ÌÖêÏ∏† */
    .main-content {
      padding: 0 20px 20px 20px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    /* Ïπ¥Îìú */
    .card {
      background: #fff;
      border-radius: 20px;
      padding: 28px 24px;
    }

    .card-title {
      font-size: 18px;
      font-weight: 700;
      margin-bottom: 16px;
      color: #110F1A;
    }

    /* ÎÑ§Ïù¥Î∞ç ÏïÑÏù¥ÌÖú Î¶¨Ïä§Ìä∏ */
    .naming-list {
      display: flex;
      flex-direction: column;
      margin-bottom: 20px;
    }

    .naming-item {
      display: flex;
      align-items: center;
      height: 60px;
      cursor: pointer;
    }

    .naming-item .icon {
      width: 24px;
      height: 24px;
      margin-right: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .naming-item .icon svg {
      width: 24px;
      height: 24px;
    }

    .naming-item .label {
      flex: 1;
      font-size: 14px;
      font-weight: 500;
      color: #110F1A;
    }

    .naming-item .radio {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      border: 2px solid #D7D8E5;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #D7D8E5;
    }

    .naming-item .radio::after {
      content: '';
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background: #fff;
    }

    .naming-item .radio.active {
      border-color: #FF424D;
      background: #FF424D;
    }

    /* Î≤ÑÌäº Í∑∏Î£π */
    .button-group {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .btn {
      width: 100%;
      height: 52px;
      border: none;
      border-radius: 12px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 18px 16px;
    }

    .btn-primary {
      background: #120E33;
      color: #fff;
    }

    .btn-primary:hover {
      background: #1a1545;
    }

    .btn-secondary {
      background: #fff;
      color: #110F1A;
      border: 1px solid #D7D8E5;
    }

    .btn-secondary:hover {
      background: #F9FAFB;
    }

    /* ÏÉÅÌÉú Î©îÏãúÏßÄ */
    .status {
      padding: 12px 16px;
      border-radius: 12px;
      font-size: 13px;
      margin-top: 10px;
      display: none;
    }

    .status.show {
      display: block;
    }

    .status.success {
      background: #ECFDF5;
      color: #059669;
    }

    .status.error {
      background: #FEF2F2;
      color: #DC2626;
    }

    .status.info {
      background: #EFF6FF;
      color: #2563EB;
    }

    /* Bridge ÌÉ≠ Ïä§ÌÉÄÏùº */
    .input-group {
      margin-bottom: 16px;
    }

    .input-label {
      font-size: 13px;
      font-weight: 500;
      color: #5A5A73;
      margin-bottom: 8px;
      display: block;
    }

    textarea {
      width: 100%;
      padding: 16px;
      border: 1px solid #D7D8E5;
      border-radius: 16px;
      font-size: 14px;
      resize: none;
      height: 100px;
      font-family: inherit;
      background: #fff;
    }

    textarea:focus {
      outline: none;
      border-color: #110F1A;
    }

    .examples-section {
      margin-top: 20px;
    }

    .examples-title {
      font-size: 12px;
      font-weight: 600;
      color: #9CA3AF;
      margin-bottom: 8px;
    }

    .example-item {
      font-size: 13px;
      color: #5A5A73;
      padding: 12px 16px;
      background: #F3F4F5;
      border-radius: 12px;
      margin-bottom: 6px;
      cursor: pointer;
    }

    .example-item:hover {
      background: #E5E7EB;
    }

    /* ÎßûÏ∂§Î≤ï Í≤ÄÏÇ¨ Í≤∞Í≥º */
    .spell-results {
      margin-top: 10px;
      display: none;
    }

    .spell-results.show {
      display: block;
    }

    .spell-item {
      background: #FFFBEB;
      border: 1px solid #FCD34D;
      border-radius: 12px;
      padding: 16px;
      margin-bottom: 8px;
      font-size: 13px;
    }

    .spell-item .original {
      color: #DC2626;
      text-decoration: line-through;
    }

    .spell-item .correct {
      color: #059669;
      font-weight: 600;
    }

    .spell-item .fix-btn {
      background: #120E33;
      color: white;
      border: none;
      border-radius: 999px;
      padding: 10px 20px;
      font-size: 12px;
      font-weight: 600;
      cursor: pointer;
      margin-top: 12px;
    }

    .spell-ok {
      background: #ECFDF5;
      color: #059669;
      padding: 16px;
      border-radius: 12px;
      font-size: 13px;
    }

    /* Î¶¨ÏÇ¨Ïù¥Ï¶à Ìï∏Îì§ */
    .resize-handle {
      position: fixed;
      bottom: 0;
      right: 0;
      width: 16px;
      height: 16px;
      cursor: nwse-resize;
      z-index: 9999;
    }

    .resize-handle::before {
      content: '';
      position: absolute;
      bottom: 3px;
      right: 3px;
      width: 8px;
      height: 8px;
      border-right: 2px solid #C7CAD9;
      border-bottom: 2px solid #C7CAD9;
    }

    /* Data Fill Ïä§ÌÉÄÏùº */
    .category-tabs {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      margin-bottom: 16px;
    }

    .category-tab {
      padding: 8px 16px;
      border-radius: 20px;
      border: 1px solid #D7D8E5;
      background: #fff;
      font-size: 13px;
      font-weight: 500;
      color: #5A5A73;
      cursor: pointer;
      transition: all 0.2s;
    }

    .category-tab:hover {
      border-color: #110F1A;
    }

    .category-tab.active {
      background: #110F1A;
      border-color: #110F1A;
      color: #fff;
    }

    .field-list {
      display: flex;
      flex-direction: column;
      gap: 4px;
      max-height: 280px;
      overflow-y: auto;
    }

    .field-item {
      display: flex;
      align-items: center;
      padding: 12px 16px;
      background: #F9FAFB;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.2s;
    }

    .field-item:hover {
      background: #F3F4F5;
    }

    .field-item.selected {
      background: #EEF2FF;
      border: 1px solid #6366F1;
    }

    .field-item .field-name {
      flex: 1;
      font-size: 13px;
      font-weight: 600;
      color: #110F1A;
    }

    .field-item .field-desc {
      font-size: 12px;
      color: #838499;
      margin-right: 8px;
    }

    .field-item .field-check {
      width: 20px;
      height: 20px;
      border-radius: 6px;
      border: 2px solid #D7D8E5;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #fff;
    }

    .field-item.selected .field-check {
      background: #6366F1;
      border-color: #6366F1;
    }

    .field-item.selected .field-check::after {
      content: '‚úì';
      color: #fff;
      font-size: 12px;
      font-weight: 700;
    }

    .data-preview {
      margin-top: 16px;
      padding: 12px 16px;
      background: #F9FAFB;
      border-radius: 12px;
      font-size: 12px;
      color: #5A5A73;
    }

    .data-preview-title {
      font-weight: 600;
      color: #110F1A;
      margin-bottom: 4px;
    }

    .data-preview-value {
      font-family: 'SF Mono', Monaco, monospace;
      color: #6366F1;
    }
  </style>
</head>
<body>
  <!-- Î¶¨ÏÇ¨Ïù¥Ï¶à Ìï∏Îì§ -->
  <div class="resize-handle" id="resizeHandle"></div>

  <!-- ÌÉ≠ Ìó§Îçî -->
  <div class="tabs-container">
    <div class="tabs" id="tabsScroller">
      <button class="tab active" data-tab="rename">Rename</button>
      <button class="tab" data-tab="bridge">Text Editor</button>
      <button class="tab" data-tab="export">Data Fil</button>
      <button class="tab" data-tab="style">Text</button>
      <button class="tab" data-tab="settings">Text</button>
    </div>
  </div>

  <!-- Rename ÌÉ≠ -->
  <div class="tab-content active" id="rename-tab">
    <div class="title-section">
      <h1 class="page-title">Naming Changer</h1>
    </div>

    <div class="main-content">
      <div class="card">
        <h2 class="card-title">Selected Naming</h2>
        <div class="naming-list">
          <div class="naming-item" data-value="Content">
            <div class="icon">
              <svg viewBox="0 0 24 24" fill="none" stroke="#110F1A" stroke-width="2">
                <rect x="3" y="3" width="7" height="7"/>
                <rect x="14" y="3" width="7" height="7"/>
                <rect x="3" y="14" width="7" height="7"/>
                <rect x="14" y="14" width="7" height="7"/>
              </svg>
            </div>
            <span class="label">Content</span>
            <div class="radio active"></div>
          </div>
          <div class="naming-item" data-value="Section">
            <div class="icon">
              <svg viewBox="0 0 24 24" fill="none" stroke="#110F1A" stroke-width="2">
                <rect x="3" y="3" width="18" height="6" rx="1"/>
                <rect x="3" y="12" width="18" height="9" rx="1"/>
              </svg>
            </div>
            <span class="label">Section</span>
            <div class="radio"></div>
          </div>
          <div class="naming-item" data-value="Item">
            <div class="icon">
              <svg viewBox="0 0 24 24" fill="none" stroke="#110F1A" stroke-width="2">
                <rect x="3" y="3" width="18" height="18" rx="2"/>
                <line x1="9" y1="3" x2="9" y2="21"/>
              </svg>
            </div>
            <span class="label">Item</span>
            <div class="radio"></div>
          </div>
          <div class="naming-item" data-value="Image">
            <div class="icon">
              <svg viewBox="0 0 24 24" fill="none" stroke="#110F1A" stroke-width="2">
                <rect x="3" y="3" width="18" height="18" rx="2"/>
                <circle cx="8.5" cy="8.5" r="1.5"/>
                <path d="M21 15l-5-5L5 21"/>
              </svg>
            </div>
            <span class="label">Image</span>
            <div class="radio"></div>
          </div>
          <div class="naming-item" data-value="Text">
            <div class="icon">
              <svg viewBox="0 0 24 24" fill="none" stroke="#110F1A" stroke-width="2">
                <polyline points="4 7 4 4 20 4 20 7"/>
                <line x1="9" y1="20" x2="15" y2="20"/>
                <line x1="12" y1="4" x2="12" y2="20"/>
              </svg>
            </div>
            <span class="label">Text</span>
            <div class="radio"></div>
          </div>
        </div>

        <div class="button-group">
          <button class="btn btn-primary" id="selectedChangeBtn">Selected Change</button>
          <button class="btn btn-secondary" id="autoRenameBtn">Auto Rename</button>
        </div>
      </div>

      <div class="status" id="renameStatus"></div>
    </div>
  </div>

  <!-- Bridge ÌÉ≠ -->
  <div class="tab-content" id="bridge-tab">
    <div class="title-section">
      <h1 class="page-title">Text Bridge</h1>
    </div>

    <div class="main-content">
      <div class="card">
        <div class="input-group">
          <label class="input-label">ÌÖçÏä§Ìä∏ Î≥ÄÍ≤Ω Î™ÖÎ†πÏñ¥</label>
          <textarea id="command" placeholder="Ïòà: ÌåîÎ°úÏõå(Ï†ÑÏ≤¥)>Ï†ÑÏ≤¥ Î©îÏãúÏßÄ"></textarea>
        </div>

        <div class="button-group">
          <button class="btn btn-primary" id="executeBtn">ÌÖçÏä§Ìä∏ Î≥ÄÍ≤Ω</button>
          <button class="btn btn-secondary" id="spellCheckBtn">ÎßûÏ∂§Î≤ï Í≤ÄÏÇ¨</button>
        </div>

        <div class="examples-section">
          <div class="examples-title">Î™ÖÎ†πÏñ¥ ÏòàÏãú</div>
          <div class="example-item" data-cmd="ÌåîÎ°úÏõå(Ï†ÑÏ≤¥)>Ï†ÑÏ≤¥ Î©îÏãúÏßÄ">Ï∞æÏïÑÏÑú Î≥ÄÍ≤Ω: Í∏∞Ï°¥ÌÖçÏä§Ìä∏>ÏÉàÌÖçÏä§Ìä∏</div>
          <div class="example-item" data-cmd=">ÏÉà ÌÖçÏä§Ìä∏">Ï†ÑÏ≤¥ Î≥ÄÍ≤Ω: >ÏÉàÌÖçÏä§Ìä∏</div>
        </div>
      </div>

      <div class="status" id="bridgeStatus"></div>
      <div class="spell-results" id="spellResults"></div>
    </div>
  </div>

  <!-- Data Fill ÌÉ≠ -->
  <div class="tab-content" id="export-tab">
    <div class="title-section">
      <h1 class="page-title">Data Fill</h1>
    </div>
    <div class="main-content">
      <div class="card">
        <div class="category-tabs">
          <button class="category-tab active" data-category="creator">ÌÅ¨Î¶¨ÏóêÏù¥ÌÑ∞</button>
          <button class="category-tab" data-category="message">Î©îÏãúÏßÄ</button>
          <button class="category-tab" data-category="fan">Ìå¨</button>
        </div>

        <div class="field-list" id="fieldList">
          <!-- ÌïÑÎìú Î™©Î°ùÏù¥ Ïó¨Í∏∞Ïóê ÎèôÏ†ÅÏúºÎ°ú ÏÉùÏÑ±Îê® -->
        </div>

        <div class="data-preview" id="dataPreview" style="display: none;">
          <div class="data-preview-title">ÎØ∏Î¶¨Î≥¥Í∏∞</div>
          <div class="data-preview-value" id="previewValue"></div>
        </div>

        <div class="button-group" style="margin-top: 16px;">
          <button class="btn btn-primary" id="applyDataBtn">ÏÑ†ÌÉù Î†àÏù¥Ïñ¥Ïóê Ï†ÅÏö©</button>
          <button class="btn btn-secondary" id="randomFillBtn">ÎûúÎç§ Ï±ÑÏö∞Í∏∞</button>
        </div>
      </div>

      <div class="status" id="dataFillStatus"></div>
    </div>
  </div>

  <!-- Style ÌÉ≠ -->
  <div class="tab-content" id="style-tab">
    <div class="title-section">
      <h1 class="page-title">Style</h1>
    </div>
    <div class="main-content">
      <div class="card">
        <h2 class="card-title">Style Manager</h2>
        <p style="color: #5A5A73; font-size: 14px;">Coming soon...</p>
      </div>
    </div>
  </div>

  <!-- Settings ÌÉ≠ -->
  <div class="tab-content" id="settings-tab">
    <div class="title-section">
      <h1 class="page-title">Settings</h1>
    </div>
    <div class="main-content">
      <div class="card">
        <h2 class="card-title">Plugin Settings</h2>
        <p style="color: #5A5A73; font-size: 14px;">Coming soon...</p>
      </div>
    </div>
  </div>

  <script>
    // ===== ÌÉ≠ ÎìúÎûòÍ∑∏ Ïä§ÌÅ¨Î°§ =====
    const tabsScroller = document.getElementById('tabsScroller');
    let isTabDragging = false;
    let tabStartX;
    let tabScrollLeft;

    tabsScroller.addEventListener('mousedown', (e) => {
      isTabDragging = true;
      tabsScroller.style.cursor = 'grabbing';
      tabStartX = e.pageX - tabsScroller.offsetLeft;
      tabScrollLeft = tabsScroller.scrollLeft;
    });

    tabsScroller.addEventListener('mouseleave', () => {
      isTabDragging = false;
      tabsScroller.style.cursor = 'grab';
    });

    tabsScroller.addEventListener('mouseup', () => {
      isTabDragging = false;
      tabsScroller.style.cursor = 'grab';
    });

    tabsScroller.addEventListener('mousemove', (e) => {
      if (!isTabDragging) return;
      e.preventDefault();
      const x = e.pageX - tabsScroller.offsetLeft;
      const walk = (x - tabStartX) * 1.5;
      tabsScroller.scrollLeft = tabScrollLeft - walk;
    });

    // ÌÉ≠ Ï†ÑÌôò
    document.querySelectorAll('.tab').forEach(tab => {
      tab.onclick = (e) => {
        // ÎìúÎûòÍ∑∏ Ï§ëÏù¥Î©¥ ÌÅ¥Î¶≠ Î¨¥Ïãú
        if (Math.abs(e.pageX - tabsScroller.offsetLeft - tabStartX) > 5) return;

        document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
        document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
        tab.classList.add('active');
        document.getElementById(tab.dataset.tab + '-tab').classList.add('active');
      };
    });

    // ===== Rename ÌÉ≠ =====
    let selectedNaming = 'Content';
    const renameStatus = document.getElementById('renameStatus');

    document.querySelectorAll('.naming-item').forEach(item => {
      item.onclick = () => {
        document.querySelectorAll('.naming-item .radio').forEach(r => r.classList.remove('active'));
        item.querySelector('.radio').classList.add('active');
        selectedNaming = item.dataset.value;
      };
    });

    function showRenameStatus(message, type) {
      renameStatus.textContent = message;
      renameStatus.className = 'status show ' + type;
    }

    document.getElementById('selectedChangeBtn').onclick = () => {
      showRenameStatus('Ï≤òÎ¶¨ Ï§ë...', 'info');
      parent.postMessage({
        pluginMessage: { type: 'rename-selected', namingType: selectedNaming }
      }, '*');
    };

    document.getElementById('autoRenameBtn').onclick = () => {
      showRenameStatus('ÏûêÎèô ÎÑ§Ïù¥Î∞ç Ï§ë...', 'info');
      parent.postMessage({ pluginMessage: { type: 'auto-rename' } }, '*');
    };

    // ===== Bridge ÌÉ≠ =====
    const commandInput = document.getElementById('command');
    const bridgeStatus = document.getElementById('bridgeStatus');
    const spellResults = document.getElementById('spellResults');

    function showBridgeStatus(message, type) {
      bridgeStatus.textContent = message;
      bridgeStatus.className = 'status show ' + type;
    }

    document.getElementById('executeBtn').onclick = () => {
      const command = commandInput.value.trim();
      if (!command) {
        showBridgeStatus('Î™ÖÎ†πÏñ¥Î•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî', 'error');
        return;
      }
      showBridgeStatus('Ï≤òÎ¶¨ Ï§ë...', 'info');
      parent.postMessage({ pluginMessage: { type: 'execute-command', command } }, '*');
    };

    document.getElementById('spellCheckBtn').onclick = () => {
      showBridgeStatus('ÎßûÏ∂§Î≤ï Í≤ÄÏÇ¨ Ï§ë...', 'info');
      spellResults.className = 'spell-results';
      spellResults.innerHTML = '';
      parent.postMessage({ pluginMessage: { type: 'spell-check' } }, '*');
    };

    document.querySelectorAll('.example-item').forEach(el => {
      el.onclick = () => { commandInput.value = el.dataset.cmd; };
    });

    // ===== Î©îÏãúÏßÄ ÏàòÏã† =====
    window.onmessage = (event) => {
      const msg = event.data.pluginMessage;

      if (msg.type === 'status') showBridgeStatus(msg.message, msg.status);
      if (msg.type === 'rename-status') showRenameStatus(msg.message, msg.status);
      if (msg.type === 'data-fill-status') showDataFillStatus(msg.message, msg.status);

      if (msg.type === 'spell-results') {
        bridgeStatus.className = 'status';
        spellResults.className = 'spell-results show';

        if (msg.errors.length === 0) {
          spellResults.innerHTML = '<div class="spell-ok">ÎßûÏ∂§Î≤ï Ïò§Î•òÍ∞Ä ÏóÜÏäµÎãàÎã§!</div>';
        } else {
          spellResults.innerHTML = msg.errors.map((err, idx) => `
            <div class="spell-item">
              <div><span class="original">${err.original}</span> ‚Üí <span class="correct">${err.correct}</span></div>
              <div style="color:#5A5A73;margin-top:6px;font-size:12px;">${err.help || ''}</div>
              <button class="fix-btn" data-idx="${idx}">ÏàòÏ†ïÌïòÍ∏∞</button>
            </div>
          `).join('');

          spellResults.querySelectorAll('.fix-btn').forEach(btn => {
            btn.onclick = () => {
              const idx = parseInt(btn.dataset.idx);
              const err = msg.errors[idx];
              parent.postMessage({
                pluginMessage: { type: 'execute-command', command: `${err.original}>${err.correct}` }
              }, '*');
            };
          });
        }
      }

      if (msg.type === 'check-spelling') checkSpelling(msg.texts);
    };

    async function checkSpelling(texts) {
      const errors = [];
      for (const text of texts) {
        try {
          const response = await fetch('https://m.search.naver.com/p/csearch/ocontent/util/SpellerProxy', {
            method: 'POST',
            headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
            body: `q=${encodeURIComponent(text)}`
          });
          const data = await response.json();
          if (data.message?.result?.errata_count > 0) {
            const result = data.message.result;
            if (result.html !== result.notag_html) {
              errors.push({ original: text, correct: result.notag_html, help: `${result.errata_count}Í∞ú Ïò§Î•ò Î∞úÍ≤¨` });
            }
          }
        } catch (e) { console.error('ÎßûÏ∂§Î≤ï Í≤ÄÏÇ¨ Ïò§Î•ò:', e); }
      }
      const uniqueErrors = errors.filter((err, idx, self) =>
        idx === self.findIndex(e => e.original === err.original && e.correct === err.correct)
      ).filter(err => err.original !== err.correct);
      parent.postMessage({ pluginMessage: { type: 'spell-check-response', errors: uniqueErrors } }, '*');
    }

    // ===== Data Fill ÌÉ≠ =====
    const dummyData = {
      creator: [
        { name: 'CreatorName', desc: 'ÌÅ¨Î¶¨ÏóêÏù¥ÌÑ∞ Ïù¥Î¶Ñ', values: ['ÎßàÎ£®ÏóêÎ™Ω', 'ÌïòÎäòÎ≥Ñ', 'Îã¨ÏΩ§Ïù¥', 'ÎΩÄÏÜ°Ïù¥', 'ÎØºÌä∏Ï¥àÏΩî', 'ÎùºÎñºÎÉ•', 'ÏΩîÏΩîÏïÑ', 'Î∞îÎãêÎùº'] },
        { name: 'CreatorHandle', desc: '@ÏïÑÏù¥Îîî', values: ['@mimolemon', '@skystar', '@sweetie', '@fluffy', '@mintchoco', '@lattecat', '@cocoa', '@vanilla'] },
        { name: 'CreatorAvatar', desc: 'ÌîÑÎ°úÌïÑ Ïù¥ÎØ∏ÏßÄ', values: ['img/creatorAvatar/maruemon.jpg', 'img/creatorAvatar/skystar.jpg', 'img/creatorAvatar/sweetie.jpg'] },
        { name: 'CoverImages', desc: 'Ïª§Î≤Ñ Ïù¥ÎØ∏ÏßÄ', values: ['img/cover/jubin9_1.jpg', 'img/cover/sunset_2.jpg', 'img/cover/nature_3.jpg'] },
        { name: 'FollowersText', desc: 'ÌåîÎ°úÏõå Ïàò', values: ['5.3K ÌåîÎ°úÏõå', '12.1K ÌåîÎ°úÏõå', '890 ÌåîÎ°úÏõå', '45.2K ÌåîÎ°úÏõå', '3.2K ÌåîÎ°úÏõå'] },
        { name: 'PostsText', desc: 'Ìè¨Ïä§Ìä∏ Ïàò', values: ['140 Ìè¨Ïä§Ìä∏', '89 Ìè¨Ïä§Ìä∏', '256 Ìè¨Ïä§Ìä∏', '42 Ìè¨Ïä§Ìä∏', '178 Ìè¨Ïä§Ìä∏'] },
        { name: 'bioText', desc: 'ÏÜåÍ∞úÍ∏Ä', values: ['ÏóêÎ™ΩÏóêÎ™Ω ÎùºÏù¥ÌÇ§Ïóê Îì±Ïû•! Î∞©ÏÜ°(ÏπòÏßÄÏßÅ) Ïù¥ Ïô∏Ïóê ÎßàÎ£®ÏóêÎ™ΩÏùÑ ÎùºÏù¥ÌÇ§ÏóêÏÑú ÎßåÎÇòÏöî~', 'ÏùºÏÉÅÏùÑ Í≥µÏú†ÌïòÎäî ÌÅ¨Î¶¨ÏóêÏù¥ÌÑ∞ÏûÖÎãàÎã§ ‚ú®', 'Ïó¨ÌñâÍ≥º ÎßõÏßëÏùÑ Ï¢ãÏïÑÌïòÎäî ÏÇ¨Îûå üåè'] }
      ],
      message: [
        { name: 'CreatorName', desc: 'ÌÅ¨Î¶¨ÏóêÏù¥ÌÑ∞ Ïù¥Î¶Ñ', values: ['ÎßàÎ£®ÏóêÎ™Ω', 'ÌïòÎäòÎ≥Ñ', 'Îã¨ÏΩ§Ïù¥', 'ÎΩÄÏÜ°Ïù¥'] },
        { name: 'CreatorHandle', desc: '@ÏïÑÏù¥Îîî', values: ['@mimolemon', '@skystar', '@sweetie', '@fluffy'] },
        { name: 'CreatorAvatar', desc: 'ÌîÑÎ°úÌïÑ Ïù¥ÎØ∏ÏßÄ', values: ['img/creatorAvatar/maruemon.jpg', 'img/creatorAvatar/skystar.jpg'] },
        { name: 'ChatLastMessage', desc: 'ÎßàÏßÄÎßâ Î©îÏãúÏßÄ', values: ['ÏïÑ 22:30~Ïù¥ÌõÑ ÎïåÎßå Î©§Î≤ÑÌïúÌÖå ÌÜ°ÌÜ°...', 'ÏïàÎÖïÌïòÏÑ∏Ïöî! Î¨∏Ïùò Ï£ºÏÖîÏÑú Í∞êÏÇ¨Ìï¥Ïöî', 'ÎÑ§ ÌôïÏù∏ÌñàÏäµÎãàÎã§~', 'Í≥ß Í≥µÏßÄ Ïò¨Î¶¥Í≤åÏöî!'] },
        { name: 'ChatLastMessageTime', desc: 'Î©îÏãúÏßÄ ÏãúÍ∞Å', values: ['05Ïõî 16Ïùº', 'Ïò§Ï†Ñ 10:30', 'Ïñ¥Ï†ú', '3Ïùº Ï†Ñ'] }
      ],
      fan: [
        { name: 'FanName', desc: 'Ìå¨ Ïù¥Î¶Ñ', values: ['ÎßàÎ£®ÏóêÎ™Ω', 'Î≥ÑÎπõÏÜåÎÖÄ', 'ÌïòÎäòÍµ¨Î¶Ñ', 'Îã¨ÏΩ§ÌïúÏò§ÌõÑ', 'ÎØºÌä∏Ìñ•Í∏∞'] },
        { name: 'FanHandle', desc: '@ÏïÑÏù¥Îîî', values: ['@mimolemon', '@stargirl', '@skycloud', '@sweetafternoon', '@mintscent'] },
        { name: 'FanAvatar', desc: 'Ìå¨ ÌîÑÎ°úÌïÑ', values: ['img/creatorAvatar/maruemon.jpg', 'img/fan/user001.jpg', 'img/fan/user002.jpg'] },
        { name: 'FanLastMessage', desc: 'ÎßàÏßÄÎßâ Î©îÏãúÏßÄ', values: ['ÏïÑ 22:30~Ïù¥ÌõÑ ÎïåÎßå Î©§Î≤ÑÌïúÌÖå ÌÜ°ÌÜ°...', 'ÏùëÏõêÌï©ÎãàÎã§!', 'ÏÉà ÏòÅÏÉÅ ÎÑàÎ¨¥ Ï¢ãÏïòÏñ¥Ïöî „Ö†„Ö†'] },
        { name: 'FanLastMessageTime', desc: 'Î©îÏãúÏßÄ ÏãúÍ∞Å', values: ['05Ïõî 16Ïùº', 'Ïò§Ï†Ñ 10:30', 'Ïñ¥Ï†ú', 'Î∞©Í∏à Ï†Ñ'] }
      ]
    };

    let currentCategory = 'creator';
    let selectedField = null;
    const fieldList = document.getElementById('fieldList');
    const dataPreview = document.getElementById('dataPreview');
    const previewValue = document.getElementById('previewValue');
    const dataFillStatus = document.getElementById('dataFillStatus');

    function renderFields(category) {
      const fields = dummyData[category];
      fieldList.innerHTML = fields.map(field => `
        <div class="field-item" data-field="${field.name}">
          <span class="field-name">${field.name}</span>
          <span class="field-desc">${field.desc}</span>
          <div class="field-check"></div>
        </div>
      `).join('');

      fieldList.querySelectorAll('.field-item').forEach(item => {
        item.onclick = () => {
          fieldList.querySelectorAll('.field-item').forEach(i => i.classList.remove('selected'));
          item.classList.add('selected');
          selectedField = item.dataset.field;

          const field = fields.find(f => f.name === selectedField);
          if (field) {
            dataPreview.style.display = 'block';
            previewValue.textContent = field.values[0];
          }
        };
      });
    }

    document.querySelectorAll('.category-tab').forEach(tab => {
      tab.onclick = () => {
        document.querySelectorAll('.category-tab').forEach(t => t.classList.remove('active'));
        tab.classList.add('active');
        currentCategory = tab.dataset.category;
        selectedField = null;
        dataPreview.style.display = 'none';
        renderFields(currentCategory);
      };
    });

    function showDataFillStatus(message, type) {
      dataFillStatus.textContent = message;
      dataFillStatus.className = 'status show ' + type;
    }

    document.getElementById('applyDataBtn').onclick = () => {
      if (!selectedField) {
        showDataFillStatus('ÌïÑÎìúÎ•º ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî', 'error');
        return;
      }
      const field = dummyData[currentCategory].find(f => f.name === selectedField);
      if (field) {
        // Ïù¥ÎØ∏ÏßÄ ÌÉÄÏûÖÏù∏ Í≤ΩÏö∞
        if (field.isImage) {
          showDataFillStatus('Ïù¥ÎØ∏ÏßÄ Î°úÎî© Ï§ë...', 'info');
          parent.postMessage({
            pluginMessage: { type: 'apply-image-fill', imageType: field.imageType }
          }, '*');
        } else {
          // ÌÖçÏä§Ìä∏ ÌÉÄÏûÖÏù∏ Í≤ΩÏö∞
          const randomValue = field.values[Math.floor(Math.random() * field.values.length)];
          showDataFillStatus('Ï†ÅÏö© Ï§ë...', 'info');
          parent.postMessage({
            pluginMessage: { type: 'apply-dummy-data', value: randomValue }
          }, '*');
        }
      }
    };

    document.getElementById('randomFillBtn').onclick = () => {
      showDataFillStatus('ÎûúÎç§ Ï±ÑÏö∞Í∏∞ Ï§ë...', 'info');
      parent.postMessage({
        pluginMessage: { type: 'random-fill', category: currentCategory, data: dummyData[currentCategory] }
      }, '*');
    };

    // Ï¥àÍ∏∞ Î†åÎçîÎßÅ
    renderFields('creator');

    // ===== Î¶¨ÏÇ¨Ïù¥Ï¶à Í∏∞Îä• =====
    const resizeHandle = document.getElementById('resizeHandle');
    let isResizing = false;
    let startX, startY, startWidth, startHeight;

    resizeHandle.addEventListener('mousedown', (e) => {
      isResizing = true;
      startX = e.clientX;
      startY = e.clientY;
      startWidth = window.innerWidth;
      startHeight = window.innerHeight;
      e.preventDefault();
    });

    document.addEventListener('mousemove', (e) => {
      if (!isResizing) return;

      const newWidth = Math.max(300, startWidth + (e.clientX - startX));
      const newHeight = Math.max(400, startHeight + (e.clientY - startY));

      parent.postMessage({
        pluginMessage: { type: 'resize', width: newWidth, height: newHeight }
      }, '*');
    });

    document.addEventListener('mouseup', () => {
      isResizing = false;
    });
  </script>
</body>
</html>
